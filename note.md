# 操作笔记

### takeoff 的原理

- takeoff的原理是利用了pose_action,当pose_action达到了之后,就以为是takeoff完成了.  
- 现在要改变这一点.当高度达到之后就马上切位置控制模式


~~~
后来我放弃了= =
~~~
不用他的takeoff了,我自己写吧= =


现在差不多实现了takeoff的逻辑,但是控制还是不能恢复.  
原因是因为其中有个command_estop 变量.  
解决办法:  
0. 在takeoff action起作用的时候,同时发送一个pose action 的goal
> 已经按照这个写了,但是效果还是不好.主要是衔接问题.  
> 图像有个非常棘手的问题就是初始化.这个初始化做的也不是很好.  

0. 所有还是要完善呢  
初始化问题如何解决?  
飞到一个高度之后,可以估计出一个高度和位置.

0. 所有的位置,高度,轨迹一定要连续.坐标转换一定要正确.不然会出现各种各样的问题.使用偷懒的方法也行.  
其实写完整的方法,就是偷懒的方法.一下懒后面就全都懒了.  
看心情抽时间做一下这个事情.

0. 使用twist来模拟同时传输position 和 velocity
飞机上观测的position和velocity是以飞机自身为坐标系,不是以地面为坐标系,所以从图像上获取信息的话,需要一个转换矩阵.  
这个转换矩阵和yaw有关系  
使用飞机自身估计出来的yaw角来进行估计吧.
